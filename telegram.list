# =======================================================
# 规则名称: Telegram Watertight (IP-CIDR Fix)
# 核心痛点: 修复 "Connecting..." / "一直在转圈"
# 修复原理: 放弃查询归属地，直接强制接管官方 IP 段
# =======================================================

# [Part 1: 核心域名 & 短链]
DOMAIN-SUFFIX,telegram.org
DOMAIN-SUFFIX,telegram.me
DOMAIN-SUFFIX,telegram.dog
DOMAIN-SUFFIX,t.me
DOMAIN-SUFFIX,tx.me
DOMAIN-SUFFIX,tdesktop.com
DOMAIN-SUFFIX,telegra.ph
DOMAIN-SUFFIX,telesco.pe
DOMAIN-SUFFIX,tg.dev
DOMAIN-SUFFIX,graph.org
DOMAIN-SUFFIX,legra.ph
DOMAIN-SUFFIX,telegram-cdn.org
DOMAIN-SUFFIX,tgusercontent.com
DOMAIN-SUFFIX,cdn-telegram.org

# [Part 2: 暴力关键字]
DOMAIN-KEYWORD,telegram
DOMAIN-KEYWORD,nicegram

# [Part 3: 协议层 & 进程兜底]
USER-AGENT,Telegram*
USER-AGENT,Nicegram*
USER-AGENT,iMe*
USER-AGENT,Turrit*
USER-AGENT,Swiftgram*
USER-AGENT,Unigram*
PROCESS-NAME,Telegram
PROCESS-NAME,Telegram.exe

# =======================================================
# [Part 4: 终极修复 - IP-CIDR (IPv4)]
# 这里的 IP 是写死在 Telegram 客户端代码里的。
# 不管 ASN 数据库怎么变，这些 IP 永远是 Telegram 的。
# =======================================================

# 欧洲/全球核心 (DC2/DC4)
IP-CIDR,91.108.0.0/16
IP-CIDR,91.108.4.0/22
IP-CIDR,91.108.8.0/22
IP-CIDR,91.108.12.0/22
IP-CIDR,91.108.16.0/22
IP-CIDR,91.108.20.0/22
IP-CIDR,91.108.56.0/22

# 美洲/全球 (DC1/DC3)
IP-CIDR,149.154.160.0/20
IP-CIDR,149.154.164.0/22
IP-CIDR,149.154.168.0/22
IP-CIDR,149.154.172.0/22

# 辅助/遗留网段
IP-CIDR,5.28.192.0/18
IP-CIDR,109.239.140.0/24
IP-CIDR,185.76.151.0/24

# =======================================================
# [Part 5: 终极修复 - IP-CIDR6 (IPv6)]
# 如果您的网络环境支持 IPv6，Telegram 会优先尝试 IPv6。
# 漏了这些也会导致转圈。
# =======================================================
IP-CIDR6,2001:b28::/32
IP-CIDR6,2001:67c:4e8::/48
IP-CIDR6,2001:0b28::/32

# =======================================================
# [Part 6: ASN 备用兜底]
# 放在最后作为双重保险
# =======================================================
IP-ASN,62041
IP-ASN,59930
IP-ASN,44907
IP-ASN,211157
IP-ASN,60239
